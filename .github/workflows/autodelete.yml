    - name: Retain latest package version
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        REPO: ${{ github.repository }}
        PACKAGE_TYPE: ${{ github.event.inputs.package_type || 'container' }}
      run: |
        python - <<EOF
        import requests
        import os
        import json
        from datetime import datetime

        owner, repo = os.environ['REPO'].split('/')
        package_type = os.environ['PACKAGE_TYPE']
        token = os.environ['GITHUB_TOKEN']

        api_url = f"https://api.github.com/user/packages/{package_type}/{repo}/versions"

        headers = {
            "Accept": "application/vnd.github+json",
            "Authorization": f"token {token}",
            "X-GitHub-Api-Version": "2022-11-28"
        }

        response = requests.get(api_url, headers=headers)
        print(f"API Response Status Code: {response.status_code}")
        print(f"API Response Content: {response.text[:500]}...")  # 打印前500个字符

        if response.status_code != 200:
            print(f"Error: API request failed with status code {response.status_code}")
            print(f"Response content: {response.text}")
            exit(1)

        try:
            versions = response.json()
        except json.JSONDecodeError:
            print("Error: Failed to parse JSON response")
            print(f"Response content: {response.text}")
            exit(1)

        if not isinstance(versions, list):
            print(f"Error: Unexpected response format. Expected a lis
